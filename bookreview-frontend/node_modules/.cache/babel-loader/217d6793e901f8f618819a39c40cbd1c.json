{"remainingRequest":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\src\\store\\auth.module.js","dependencies":[{"path":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\src\\store\\auth.module.js","mtime":1651033973000},{"path":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\babel.config.js","mtime":1651033973000},{"path":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1696829102433},{"path":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1696829103304},{"path":"D:\\Dự Án Web\\web_review_truyen\\ct449-main\\bookreview-frontend\\node_modules\\eslint-loader\\index.js","mtime":1696829102655}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkQ6XFxEXHUxRUYxIFx4QzFuIFdlYlxcd2ViX3Jldmlld190cnV5ZW5cXGN0NDQ5LW1haW5cXGJvb2tyZXZpZXctZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXHNsaWNlZFRvQXJyYXkuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRDpcXERcdTFFRjEgXHhDMW4gV2ViXFx3ZWJfcmV2aWV3X3RydXllblxcY3Q0NDktbWFpblxcYm9va3Jldmlldy1mcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgaHR0cCBmcm9tICIuLi9jb21tb24vaHR0cCI7CmltcG9ydCB7IGhhbmRsZSB9IGZyb20gIi4uL2NvbW1vbi9wcm9taXNlIjsKdmFyIHN0YXRlID0gewogIHVzZXI6IHsKICAgIGlkOiBTdHJpbmcsCiAgICB1c2VybmFtZTogU3RyaW5nLAogICAgZW1haWw6IFN0cmluZywKICAgIGFjY2Vzc1Rva2VuOiBTdHJpbmcKICB9LAogIHN0YXR1czogewogICAgbG9nZ2VkSW46IEJvb2xlYW4KICB9Cn07CnZhciBtdXRhdGlvbnMgPSB7CiAgaW5pdEF1dGhTdGF0ZTogZnVuY3Rpb24gaW5pdEF1dGhTdGF0ZShzdGF0ZSkgewogICAgc3RhdGUudXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXIiKSk7CiAgICBzdGF0ZS5zdGF0dXMubG9nZ2VkSW4gPSAhIXN0YXRlLnVzZXI7CiAgfSwKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oc3RhdGUsIHVzZXIpIHsKICAgIHN0YXRlLnN0YXR1cy5sb2dnZWRJbiA9IHRydWU7CiAgICBzdGF0ZS51c2VyID0gdXNlcjsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ1c2VyIiwgSlNPTi5zdHJpbmdpZnkodXNlcikpOwogIH0sCiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoc3RhdGUpIHsKICAgIHN0YXRlLnN0YXR1cy5sb2dnZWRJbiA9IGZhbHNlOwogICAgc3RhdGUudXNlciA9IG51bGw7CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgidXNlciIpOwogIH0sCiAgY2xlYXJMb2dpblN0YXR1czogZnVuY3Rpb24gY2xlYXJMb2dpblN0YXR1cyhzdGF0ZSkgewogICAgc3RhdGUuc3RhdHVzLmxvZ2dlZEluID0gZmFsc2U7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlcikgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGNvbW1pdCwgX3lpZWxkJGhhbmRsZSwgX3lpZWxkJGhhbmRsZTIsIGVycm9yLCByZXNwb25zZTsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGh0dHAucG9zdCgiL2F1dGgvc2lnbmluIiwgewogICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogdXNlci5wYXNzd29yZAogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBfeWllbGQkaGFuZGxlID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfeWllbGQkaGFuZGxlMiA9IF9zbGljZWRUb0FycmF5KF95aWVsZCRoYW5kbGUsIDIpOwogICAgICAgICAgICAgIGVycm9yID0gX3lpZWxkJGhhbmRsZTJbMF07CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfeWllbGQkaGFuZGxlMlsxXTsKCiAgICAgICAgICAgICAgaWYgKCEoZXJyb3IgfHwgIXJlc3BvbnNlLmRhdGEuYWNjZXNzVG9rZW4pKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbW1pdCgibG9nb3V0Iik7CgogICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCJXaG9vcHMsIG5vIGFjY2VzcyB0b2tlbiBmb3VuZCEiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IGVycm9yOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjb21taXQoImxvZ2luIiwgcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcG9uc2UuZGF0YSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgcmVnaXN0ZXI6IGZ1bmN0aW9uIHJlZ2lzdGVyKF9yZWYyLCB1c2VyKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgdmFyIGNvbW1pdCwgX3lpZWxkJGhhbmRsZTMsIF95aWVsZCRoYW5kbGU0LCBlcnJvciwgcmVzcG9uc2U7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShodHRwLnBvc3QoIi9hdXRoL3NpZ251cCIsIHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogdXNlci5wYXNzd29yZAogICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBfeWllbGQkaGFuZGxlMyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIF95aWVsZCRoYW5kbGU0ID0gX3NsaWNlZFRvQXJyYXkoX3lpZWxkJGhhbmRsZTMsIDIpOwogICAgICAgICAgICAgIGVycm9yID0gX3lpZWxkJGhhbmRsZTRbMF07CiAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfeWllbGQkaGFuZGxlNFsxXTsKICAgICAgICAgICAgICBjb21taXQoImNsZWFyTG9naW5TdGF0dXMiKTsKCiAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZXNwb25zZS5kYXRhKTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSkoKTsKICB9Cn07CnZhciBnZXR0ZXJzID0gewogIHVzZXJMb2dnZWRJbjogZnVuY3Rpb24gdXNlckxvZ2dlZEluKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUuc3RhdHVzLmxvZ2dlZEluOwogIH0sCiAgbG9nZ2VkSW5Vc2VyOiBmdW5jdGlvbiBsb2dnZWRJblVzZXIoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS51c2VyOwogIH0KfTsKZXhwb3J0IHZhciBhdXRoID0gewogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zLAogIGdldHRlcnM6IGdldHRlcnMKfTs="},{"version":3,"sources":["D:/Dự Án Web/web_review_truyen/ct449-main/bookreview-frontend/src/store/auth.module.js"],"names":["http","handle","state","user","id","String","username","email","accessToken","status","loggedIn","Boolean","mutations","initAuthState","JSON","parse","localStorage","getItem","login","setItem","stringify","logout","removeItem","clearLoginStatus","actions","commit","post","password","error","response","data","Error","register","getters","userLoggedIn","loggedInUser","auth"],"mappings":"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","sourcesContent":["import http from \"../common/http\";\nimport { handle } from \"../common/promise\";\n\nconst state = {\n    user: {\n        id: String,\n        username: String,\n        email: String,\n        accessToken: String\n    },\n    status: {\n        loggedIn: Boolean\n    }\n};\n\nconst mutations = {\n    initAuthState(state) {\n        state.user = JSON.parse(localStorage.getItem(\"user\"));\n        state.status.loggedIn = !!state.user;\n    },\n    login(state, user) {\n        state.status.loggedIn = true;\n        state.user = user;\n        localStorage.setItem(\"user\", JSON.stringify(user));\n    },\n    logout(state) {\n        state.status.loggedIn = false;\n        state.user = null;\n        localStorage.removeItem(\"user\");\n    },\n    clearLoginStatus(state) {\n        state.status.loggedIn = false;\n    },\n};\n\nconst actions = {\n    async login({ commit }, user) {\n        let [error, response] = await handle(\n            http.post(\"/auth/signin\", {\n                username: user.username,\n                password: user.password,\n            })\n        );\n\n        if (error || !response.data.accessToken) {\n            commit(\"logout\");\n            if (!error) {\n                error = new Error(\"Whoops, no access token found!\");\n            }\n            throw error;\n        }\n\n        commit(\"login\", response.data);\n        return response.data;\n    },\n    async register({ commit }, user) {\n        const [error, response] = await handle(\n            http.post(\"/auth/signup\", {\n                username: user.username,\n                email: user.email,\n                password: user.password,\n            })\n        );\n\n        commit(\"clearLoginStatus\");\n        if (error) {\n            throw error;\n        }\n        return response.data;\n    }\n};\n\nconst getters = {\n    userLoggedIn(state) {\n        return state.status.loggedIn;\n    },\n    loggedInUser(state) {\n        return state.user;\n    }\n};\nexport const auth = {\n    state,\n    mutations,\n    actions,\n    getters\n};"]}]}